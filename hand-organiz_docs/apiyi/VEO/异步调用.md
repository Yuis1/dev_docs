# 异步调用
## 1. 创建视频任务

### 请求头
Content-Type: application/json
Authorization: sk-APIKEY

### 请求参数

模型名称。可选值：

-   `veo-3.1` - 竖屏标准版
-   `veo-3.1-fl` - 竖屏+帧转视频
-   `veo-3.1-fast` - 竖屏快速版
-   `veo-3.1-fast-fl` - 竖屏快速+帧转视频
-   `veo-3.1-landscape` - 横屏标准版
-   `veo-3.1-landscape-fl` - 横屏+帧转视频
-   `veo-3.1-landscape-fast` - 横屏快速版
-   `veo-3.1-landscape-fast-fl` - 横屏快速+帧转视频

备注：
-fl 代表帧转视频模式（Frame-to-Video）
-fast 代表快速生成，用时短、价格更便宜
默认为竖屏，带 landscape 的为横屏

### 请求示例
const response = await fetch('https://api.apiyi.com/v1/videos', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': 'sk-your-api-key'
  },
  body: JSON.stringify({
    prompt: '画小猫',
    model: 'veo-3.1'
  })
});

const data = await response.json();
console.log(data);

### 响应示例
响应中的 id 字段即为视频任务 ID，后续用于查询任务状态和获取视频内容。


## 2. 查询视频任务状态
/v1/videos/{video_id}
查询视频生成任务的当前状态

路径参数：
video_id  string  必填
视频任务 ID（从创建接口返回）

请求头：
Authorization: sk-APIKEY

### 请求示例
const videoId = 'video_abc123';
const response = await fetch(`https://api.apiyi.com/v1/videos/${videoId}`, {
  headers: {
    'Authorization': 'sk-your-api-key'
  }
});

const data = await response.json();
console.log(data);

### 响应示例

### 状态说明

|     状态     |  说明   |  下一步操作   |
|------------|-------|----------|
|   `queued`   | 任务排队中 |  继续轮询状态  |
| `processing` | 任务处理中 |  继续轮询状态  |
| `completed`  | 生成完成  | 调用获取内容接口 |
|   `failed`   | 生成失败  |  检查错误信息  |

## 3. 获取视频内容
/v1/videos/{video_id}/content

获取已生成视频的实际内容

### 路径参数
video_id  string  必填
视频任务 ID

### 请求头
Authorization: sk-APIKEY

### 请求示例
const videoId = 'video_abc123';
const response = await fetch(`https://api.apiyi.com/v1/videos/${videoId}/content`, {
  headers: {
    'Authorization': 'sk-your-api-key'
  }
});

const data = await response.json();
console.log(data);

### 响应示例
视频 URL 有效期通常为 24 小时，建议及时下载保存。


## 完整调用流程
1创建任务
调用 POST /v1/videos 接口创建视频生成任务，获取 video_id

2轮询状态
使用 GET /v1/videos/ 接口轮询任务状态，直到状态为 completed

3获取视频
调用 GET /v1/videos//content 接口获取视频 URL

4下载视频
从返回的 URL 下载视频文件并保存

## 错误处理

### 常见错误码

|      错误码       |    说明    |       解决方案        |
|----------------|----------|-------------------|
| `invalid_api_key`  | API 密钥无效 |   检查 API 密钥是否正确   |
| `invalid_model`  |  模型不存在   |     使用支持的模型名称     |
| `invalid_prompt` |  提示词无效   |    检查提示词长度和内容     |
| `video_not_found`  | 视频任务不存在  | 检查 video\_id 是否正确 |
| `video_not_ready`  | 视频尚未生成完成 |     继续轮询任务状态      |
| `quota_exceeded` |   配额超限   |     联系客服增加配额      |

### 错误响应格式

```
{
  "error": {
    "code": "invalid_api_key",
    "message": "Invalid API key provided",
    "type": "authentication_error"
  }
}
```



## 首尾帧模式
Veo 3.1 支持上传 2 张图片，分别作为视频的首帧和尾帧。AI 会自动生成中间的过渡动画，实现从 A 到 B 的平滑转换。

Veo 3.1 的两张图可以是完全不同的内容吗？
可以，但建议有一定的视觉关联。Veo 3.1 会尝试在两张图之间创建平滑过渡，如果内容差异过大，可能导致过渡效果不自然。最佳实践是首尾图在构图、色调或主体上有一定连续性。

## 参考图模式
暂不支持